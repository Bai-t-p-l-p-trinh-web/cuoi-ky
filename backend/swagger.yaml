openapi: 3.0.0
info:
  title: FakeAuto API
  version: 1.0.0
  description: Tài liệu API cho hệ thống FakeAuto - Hệ thống quản lý mua bán xe ô tô

servers:
  - url: https://fakeauto.id.vn
    description: Development server

paths:
  /api/v1/auth/register:
    post:
      tags: [Auth]
      summary: Đăng ký tài khoản
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                  description: Địa chỉ email của người dùng
                name:
                  type: string
                  description: Tên người dùng
                password:
                  type: string
                  description: Mật khẩu (ít nhất 8 ký tự, 1 chữ hoa, 1 ký tự đặc biệt)
              required:
                - email
                - name
                - password
      responses:
        '201':
          description: Tài khoản được tạo thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      actionRequired:
                        type: string
                        enum: [VERIFY_REGISTER, REQUEST_OTP_AGAIN]
                      userId:
                        type: string
                        description: ID của người dùng (nếu gửi OTP thất bại)
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/login:
    post:
      tags: [Auth]
      summary: Đăng nhập
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
              required:
                - email
                - password
      responses:
        '200':
          description: Đăng nhập thành công hoặc yêu cầu xác thực OTP
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      user:
                        $ref: '#/components/schemas/User'
                      accessToken:
                        type: string
                        description: JWT Access Token
                      actionRequired:
                        type: string
                        enum: [VERIFY_2FA_LOGIN, VERIFY_FIRST_TIME]
                        description: Hành động cần thực hiện nếu cần xác thực
        '400':
          description: Lỗi thông tin đăng nhập
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/verify-login-otp:
    post:
      tags: [Auth]
      summary: Xác minh OTP đăng nhập
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                otp:
                  type: string
                  description: Mã OTP 6 chữ số
                type:
                  type: string
                  enum: [VERIFY_2FA_LOGIN, VERIFY_FIRST_TIME]
              required:
                - email
                - otp
                - type
      responses:
        '200':
          description: Xác minh OTP thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      userId:
                        type: string
                      verificationType:
                        type: string
                      accessToken:
                        type: string
                        description: JWT Access Token
                      refreshToken:
                        type: string
                        description: JWT Refresh Token
        '400':
          description: Lỗi OTP không hợp lệ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/send-otp:
    post:
      tags: [Auth]
      summary: Gửi mã OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                type:
                  type: string
                  enum: [VERIFY_REGISTER, VERIFY_ACCOUNT, VERIFY_2FA_LOGIN, VERIFY_CURRENT_EMAIL, VERIFY_NEW_EMAIL, VERIFY_CHANGE_PASSWORD, VERIFY_RESET_PASSWORD, REQUEST_OTP_AGAIN]
              required:
                - email
                - type
      responses:
        '200':
          description: OTP đã được gửi
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/verify-otp:
    post:
      tags: [Auth]
      summary: Xác minh mã OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                otp:
                  type: string
                  description: Mã OTP 6 chữ số
                type:
                  type: string
                  enum: [VERIFY_REGISTER, VERIFY_ACCOUNT, VERIFY_2FA_LOGIN, VERIFY_CURRENT_EMAIL, VERIFY_NEW_EMAIL, VERIFY_CHANGE_PASSWORD, VERIFY_RESET_PASSWORD, REQUEST_OTP_AGAIN]
              required:
                - email
                - otp
                - type
      responses:
        '200':
          description: Xác minh OTP thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      userId:
                        type: string
                      verificationType:
                        type: string
                      accessToken:
                        type: string
                        description: JWT Access Token (nếu type là VERIFY_FIRST_TIME)
                      refreshToken:
                        type: string
                        description: JWT Refresh Token (nếu type là VERIFY_FIRST_TIME)
        '400':
          description: Lỗi OTP không hợp lệ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/change-password:
    post:
      tags: [Auth]
      summary: Đổi mật khẩu
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                oldPassword:
                  type: string
                newPassword:
                  type: string
              required:
                - userId
                - oldPassword
                - newPassword
      responses:
        '200':
          description: Đổi mật khẩu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/change-email:
    post:
      tags: [Auth]
      summary: Thay đổi email
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                oldEmail:
                  type: string
                  format: email
                newEmail:
                  type: string
                  format: email
              required:
                - oldEmail
                - newEmail
      responses:
        '200':
          description: Yêu cầu thay đổi email thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      actionRequired:
                        type: string
                        enum: [VERIFY_NEW_EMAIL]
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/reset-password:
    post:
      tags: [Auth]
      summary: Đặt lại mật khẩu
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                newPassword:
                  type: string
              required:
                - userId
                - newPassword
      responses:
        '200':
          description: Đặt lại mật khẩu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/set-oauth-password:
    post:
      tags: [Auth]
      summary: Đặt mật khẩu cho tài khoản OAuth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
              required:
                - email
                - password
      responses:
        '200':
          description: Đặt mật khẩu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/toggle-2fa:
    post:
      tags: [Auth]
      summary: Bật/tắt xác thực hai yếu tố
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
              required:
                - userId
      responses:
        '200':
          description: Bật/tắt 2FA thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      is2FAEnabled:
                        type: boolean
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/auth/refresh-token:
    post:
      tags: [Auth]
      summary: Làm mới token
      responses:
        '200':
          description: Làm mới token thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      accessToken:
                        type: string
        '400':
          description: Thiếu refresh token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Refresh token không hợp lệ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/oauth/google:
    get:
      tags: [OAuth]
      summary: Đăng nhập bằng Google
      parameters:
        - in: query
          name: code
          schema:
            type: string
          required: true
          description: Mã code từ Google OAuth
      responses:
        '200':
          description: Chuyển hướng sau khi đăng nhập
        '403':
          description: Email Google chưa được xác minh
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/oauth/tempUser:
    get:
      tags: [OAuth]
      summary: Lấy thông tin user tạm thời sau khi đăng nhập Google
      responses:
        '200':
          description: Thông tin user tạm thời
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: string
                  email:
                    type: string
                    format: email
                  avatar:
                    type: string
        '401':
          description: Chưa xác thực Google
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/oauth/updateUser:
    post:
      tags: [OAuth]
      summary: Cập nhật thông tin người dùng sau OAuth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                phone:
                  type: string
                password:
                  type: string
                email:
                  type: string
                  format: email
                avatar:
                  type: string
              required:
                - name
                - phone
                - password
                - email
      responses:
        '200':
          description: Cập nhật thông tin thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '401':
          description: Chưa xác thực Google
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy người dùng
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/car:
    get:
      tags: [Car]
      summary: Lấy danh sách xe
      parameters:
        - in: query
          name: pricemin
          schema:
            type: integer
          description: Giá tối thiểu
        - in: query
          name: pricemax
          schema:
            type: integer
          description: Giá tối đa
        - in: query
          name: yearmin
          schema:
            type: integer
          description: Năm sản xuất tối thiểu
        - in: query
          name: yearmax
          schema:
            type: integer
          description: Năm sản xuất tối đa
        - in: query
          name: kmmin
          schema:
            type: integer
          description: Số km tối thiểu
        - in: query
          name: kmmax
          schema:
            type: integer
          description: Số km tối đa
        - in: query
          name: fuel_type
          schema:
            type: string
          description: Loại nhiên liệu (cách nhau bởi dấu +)
        - in: query
          name: seat_capacity
          schema:
            type: string
          description: Số chỗ ngồi (cách nhau bởi dấu +)
        - in: query
          name: keyword
          schema:
            type: string
          description: Từ khóa tìm kiếm
        - in: query
          name: page
          schema:
            type: integer
          description: Trang hiện tại
      responses:
        '200':
          description: Danh sách xe
          content:
            application/json:
              schema:
                type: object
                properties:
                  num:
                    type: integer
                    description: Tổng số xe
                  minPrice:
                    type: integer
                    description: Giá thấp nhất
                  maxPrice:
                    type: integer
                    description: Giá cao nhất
                  cars:
                    type: array
                    items:
                      $ref: '#/components/schemas/Car'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags: [Car]
      summary: Thêm xe mới
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CarInput'
      responses:
        '201':
          description: Tạo xe thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/car/display:
    get:
      tags: [Car]
      summary: Lấy danh sách xe của người bán
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Danh sách xe
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    title:
                      type: string
                    price:
                      type: integer
                    img_src:
                      type: string
                    status:
                      type: string
                      enum: [selling, sold]
                    slug:
                      type: string
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/car/{slugCar}:
    get:
      tags: [Car]
      summary: Lấy thông tin xe theo slug
      parameters:
        - in: path
          name: slugCar
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Thông tin xe
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Car'
        '404':
          description: Không tìm thấy xe
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    patch:
      tags: [Car]
      summary: Cập nhật thông tin xe
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: slugCar
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                price:
                  type: integer
                comment:
                  type: string
                status:
                  type: string
                  enum: [selling, sold]
      responses:
        '200':
          description: Cập nhật xe thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/Car'
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Không có quyền cập nhật
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/category:
    get:
      tags: [Category]
      summary: Lấy tất cả danh mục
      responses:
        '200':
          description: Danh sách danh mục
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Category'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags: [Category]
      summary: Thêm danh mục mới
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                position:
                  type: integer
                  description: Vị trí hiển thị
              required:
                - name
      responses:
        '201':
          description: Tạo danh mục thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/requestAdd:
    post:
      tags: [Request]
      summary: Gửi yêu cầu thêm xe
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestAddInput'
      responses:
        '201':
          description: Tạo yêu cầu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags: [Request]
      summary: Lấy danh sách yêu cầu của người dùng
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Danh sách yêu cầu
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    name:
                      type: string
                    status:
                      type: string
                      enum: [pending, checked, reject, done]
                    img_demo:
                      type: string
                    createdAt:
                      type: string
                      format: date-time
                    slug:
                      type: string
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/requestAdd/inspects:
    get:
      tags: [Request]
      summary: Lấy danh sách yêu cầu của kiểm định viên
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Danh sách yêu cầu
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RequestAdd'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/requestAdd/{slugRequest}:
    get:
      tags: [Request]
      summary: Lấy chi tiết yêu cầu theo slug
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: slugRequest
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Chi tiết yêu cầu
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RequestAdd'
        '404':
          description: Không tìm thấy yêu cầu
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags: [Request]
      summary: Xóa yêu cầu theo slug
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: slugRequest
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Xóa yêu cầu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy yêu cầu
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/requestAdd/{slugRequest}/checked:
    patch:
      tags: [Request]
      summary: Duyệt yêu cầu
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: slugRequest
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                img_src:
                  type: array
                  items:
                    type: string
                examine:
                  type: object
                  description: Thông tin kiểm tra xe
                price_recommend_low:
                  type: integer
                price_recommend_high:
                  type: integer
      responses:
        '200':
          description: Duyệt yêu cầu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/requestAdd/{slugRequest}/reject:
    patch:
      tags: [Request]
      summary: Từ chối yêu cầu
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: slugRequest
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                examine:
                  type: object
                  description: Thông tin kiểm tra xe
      responses:
        '200':
          description: Từ chối yêu cầu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/requestAdd/{slugRequest}/done:
    patch:
      tags: [Request]
      summary: Đăng xe từ yêu cầu
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: slugRequest
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                comment:
                  type: string
                price:
                  type: integer
                category_id:
                  type: string
                location:
                  type: string
              required:
                - price
      responses:
        '200':
          description: Đăng xe thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/requestAdd/{slugRequest}/employee:
    patch:
      tags: [Request]
      summary: Phân công kiểm định viên
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: slugRequest
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                  description: Danh sách ID của kiểm định viên
              required:
                - userIds
      responses:
        '200':
          description: Phân công thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy yêu cầu
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/thread/threads:
    get:
      tags: [Thread]
      summary: Lấy danh sách đoạn chat
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Danh sách đoạn chat
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  name:
                    type: string
                  email:
                    type: string
                    format: email
                  avatar:
                    type: string
                  threads:
                    type: array
                    items:
                      $ref: '#/components/schemas/Thread'
        '404':
          description: Không tìm thấy người dùng hoặc thread
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/thread/start:
    post:
      tags: [Thread]
      summary: Bắt đầu đoạn chat mới
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sellerId:
                  type: string
              required:
                - sellerId
      responses:
        '200':
          description: Thread đã sẵn sàng
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  threadId:
                    type: string
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/user/me:
    get:
      tags: [User]
      summary: Lấy thông tin người dùng hiện tại
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Thông tin người dùng
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '401':
          description: Token không hợp lệ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    patch:
      tags: [User]
      summary: Cập nhật thông tin người dùng
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                phone:
                  type: string
                address:
                  type: string
                city:
                  type: string
                district:
                  type: string
                avatar:
                  type: string
                contactFacebook:
                  type: string
                contactZalo:
                  type: string
                contactEmail:
                  type: string
                  format: email
                contactLinkedin:
                  type: string
      responses:
        '200':
          description: Cập nhật thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/User'
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy người dùng
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/user/logout:
    post:
      tags: [User]
      summary: Đăng xuất
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Đăng xuất thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/user/seller:
    patch:
      tags: [User]
      summary: Trở thành người bán
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Chuyển thành người bán thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Thiếu thông tin bắt buộc
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/user/{slugSeller}:
    get:
      tags: [User]
      summary: Lấy thông tin người bán theo slug
      parameters:
        - in: path
          name: slugSeller
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Thông tin người bán
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Seller'
        '404':
          description: Không tìm thấy người bán
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/user/staffs:
    get:
      tags: [User]
      summary: Lấy danh sách nhân viên
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Danh sách nhân viên
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/user/{slugUser}:
    patch:
      tags: [User]
      summary: Admin thay đổi vai trò người dùng
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: slugUser
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                role:
                  type: string
                  enum: [user, seller, admin]
      responses:
        '200':
          description: Thay đổi vai trò thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/user/bank-info:
    get:
      tags: [User]
      summary: Lấy thông tin ngân hàng của người dùng
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Thông tin ngân hàng
          content:
            application/json:
              schema:
                type: object
                properties:
                  bankName:
                    type: string
                  bankCode:
                    type: string
                  accountNumber:
                    type: string
                  accountHolder:
                    type: string
                  verified:
                    type: boolean
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags: [User]
      summary: Cập nhật thông tin ngân hàng
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                bankName:
                  type: string
                bankCode:
                  type: string
                accountNumber:
                  type: string
                accountHolder:
                  type: string
              required:
                - bankName
                - bankCode
                - accountNumber
                - accountHolder
      responses:
        '200':
          description: Cập nhật thông tin ngân hàng thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/user/pending-bank-verifications:
    get:
      tags: [User]
      summary: Lấy danh sách xác minh ngân hàng đang chờ
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Danh sách xác minh ngân hàng
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    userId:
                      type: string
                    bankName:
                      type: string
                    bankCode:
                      type: string
                    accountNumber:
                      type: string
                    accountHolder:
                      type: string
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/user/{userId}/verify-bank:
    put:
      tags: [User]
      summary: Xác minh thông tin ngân hàng
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                verified:
                  type: boolean
      responses:
        '200':
          description: Xác minh ngân hàng thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/statistic/views:
    get:
      tags: [Statistic]
      summary: Thống kê lượt xem
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Thống kê lượt xem
          content:
            application/json:
              schema:
                type: object
                properties:
                  date:
                    type: array
                    items:
                      type: string
                      format: date
                  views:
                    type: array
                    items:
                      type: integer
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/statistic/contacts:
    get:
      tags: [Statistic]
      summary: Thống kê liên hệ
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Thống kê liên hệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  date:
                    type: array
                    items:
                      type: string
                      format: date
                  contacts:
                    type: array
                    items:
                      type: integer
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/statistic/revenues:
    get:
      tags: [Statistic]
      summary: Thống kê doanh thu
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Thống kê doanh thu
          content:
            application/json:
              schema:
                type: object
                properties:
                  date:
                    type: array
                    items:
                      type: string
                      format: date
                  revenues:
                    type: array
                    items:
                      type: integer
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/notifications:
    post:
      tags: [Notification]
      summary: Tạo thông báo mới
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                recipient:
                  type: string
                  description: ID người nhận
                type:
                  type: string
                  enum:
                    - order_created
                    - payment_received
                    - payment_confirmed
                    - order_cancelled
                    - delivery_started
                    - delivery_confirmed
                    - order_completed
                    - refund_requested
                    - refund_approved
                    - refund_rejected
                    - refund_completed
                    - new_message
                    - new_chat
                    - car_approved
                    - car_rejected
                    - car_featured
                    - car_expired
                    - account_verified
                    - account_suspended
                    - password_changed
                    - maintenance
                    - update
                    - promotion
                    - reminder
                    - warning
                title:
                  type: string
                message:
                  type: string
                priority:
                  type: string
                  enum: [low, medium, high, urgent]
                category:
                  type: string
                actionUrl:
                  type: string
                  format: uri
                expiresAt:
                  type: string
                  format: date-time
              required:
                - recipient
                - type
                - title
                - message
      responses:
        '200':
          description: Tạo thông báo thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags: [Notification]
      summary: Lấy danh sách thông báo của người dùng
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: category
          schema:
            type: string
          description: Danh mục thông báo
        - in: query
          name: type
          schema:
            type: string
            enum:
              - order_created
              - payment_received
              - payment_confirmed
              - order_cancelled
              - delivery_started
              - delivery_confirmed
              - order_completed
              - refund_requested
              - refund_approved
              - refund_rejected
              - refund_completed
              - new_message
              - new_chat
              - car_approved
              - car_rejected
              - car_featured
              - car_expired
              - account_verified
              - account_suspended
              - password_changed
              - maintenance
              - update
              - promotion
              - reminder
              - warning
          description: Loại thông báo
        - in: query
          name: read
          schema:
            type: boolean
          description: Trạng thái đọc
        - in: query
          name: priority
          schema:
            type: string
            enum: [low, medium, high, urgent]
          description: Độ ưu tiên
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
          description: Trang hiện tại
        - in: query
          name: limit
          schema:
            type: integer
            minimum: 1
            maximum: 100
          description: Số lượng thông báo mỗi trang
        - in: query
          name: sortBy
          schema:
            type: string
            enum: [createdAt, updatedAt, priority]
          description: Sắp xếp theo
        - in: query
          name: sortOrder
          schema:
            type: string
            enum: [asc, desc]
          description: Thứ tự sắp xếp
      responses:
        '200':
          description: Danh sách thông báo
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Notification'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/notifications/{notificationId}/read:
    put:
      tags: [Notification]
      summary: Đánh dấu thông báo đã đọc
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: notificationId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Đánh dấu thông báo đã đọc thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/notifications/mark-all-read:
    put:
      tags: [Notification]
      summary: Đánh dấu tất cả thông báo đã đọc
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: category
          schema:
            type: string
          description: Danh mục thông báo
      responses:
        '200':
          description: Đánh dấu tất cả thông báo đã đọc thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/notifications/{notificationId}:
    delete:
      tags: [Notification]
      summary: Xóa thông báo
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: notificationId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Xóa thông báo thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/notifications/unread-count:
    get:
      tags: [Notification]
      summary: Lấy số lượng thông báo chưa đọc
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: category
          schema:
            type: string
          description: Danh mục thông báo
      responses:
        '200':
          description: Số lượng thông báo chưa đọc
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/notifications/statistics:
    get:
      tags: [Notification]
      summary: Lấy thống kê thông báo
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Thống kê thông báo
          content:
            application/json:
              schema:
                type: object
                properties:
                  total:
                    type: integer
                  read:
                    type: integer
                  unread:
                    type: integer
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/notiUser:
    get:
      tags: [Notification]
      summary: Lấy thông báo của người dùng
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Danh sách thông báo
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Notification'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders:
    post:
      tags: [Order]
      summary: Tạo đơn hàng mới
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                carId:
                  type: string
                paymentMethod:
                  type: string
                  enum: [deposit, full_payment, direct_transaction]
                depositPercentage:
                  type: integer
                  minimum: 10
                  maximum: 50
              required:
                - carId
                - paymentMethod
      responses:
        '200':
          description: Tạo đơn hàng thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/Order'
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags: [Order]
      summary: Lấy danh sách đơn hàng
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: role
          schema:
            type: string
            enum: [buyer, seller, all]
          description: Vai trò của người dùng
        - in: query
          name: status
          schema:
            type: string
            enum:
              - awaiting_payment
              - paid_partial
              - paid_full
              - pending_meeting
              - waiting_confirmation
              - negotiating
              - pending_final_payment
              - delivery_in_progress
              - delivered
              - buyer_confirmed
              - refunding
              - completed
              - cancelled_by_buyer
              - disputed
          description: Trạng thái đơn hàng
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
          description: Trang hiện tại
        - in: query
          name: limit
          schema:
            type: integer
            minimum: 1
            maximum: 100
          description: Số lượng đơn hàng mỗi trang
        - in: query
          name: sortBy
          schema:
            type: string
            enum: [createdAt, updatedAt, totalAmount, status]
          description: Sắp xếp theo
        - in: query
          name: sortOrder
          schema:
            type: string
            enum: [asc, desc]
          description: Thứ tự sắp xếp
      responses:
        '200':
          description: Danh sách đơn hàng
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Order'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders/confirm-payment:
    post:
      tags: [Order]
      summary: Xác nhận đã thanh toán
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                paymentId:
                  type: string
                transactionId:
                  type: string
                evidence:
                  type: array
                  items:
                    type: string
                    format: uri
              required:
                - paymentId
                - transactionId
      responses:
        '200':
          description: Xác nhận thanh toán thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders/{orderId}:
    get:
      tags: [Order]
      summary: Lấy chi tiết đơn hàng
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Chi tiết đơn hàng
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy đơn hàng
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders/{orderId}/buyer-confirm:
    put:
      tags: [Order]
      summary: Buyer xác nhận đã thống nhất với seller
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Xác nhận thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders/{orderId}/final-payment:
    post:
      tags: [Order]
      summary: Tạo thanh toán cuối cho đơn hàng đặt cọc
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Tạo thanh toán cuối thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders/{orderId}/start-delivery:
    put:
      tags: [Order]
      summary: Bắt đầu giao xe
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                deliveryInfo:
                  type: object
                  properties:
                    address:
                      type: string
                    scheduledDate:
                      type: string
                      format: date-time
      responses:
        '200':
          description: Bắt đầu giao xe thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders/{orderId}/confirm-delivery:
    put:
      tags: [Order]
      summary: Xác nhận đã giao/nhận xe
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                images:
                  type: array
                  items:
                    type: string
                    format: uri
                documents:
                  type: array
                  items:
                    type: string
                    format: uri
                notes:
                  type: string
                  maxLength: 500
      responses:
        '200':
          description: Xác nhận giao xe thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders/{orderId}/buyer-final-confirmation:
    put:
      tags: [Order]
      summary: Buyer xác nhận cuối cùng
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                satisfied:
                  type: boolean
                notes:
                  type: string
                  maxLength: 500
              required:
                - satisfied
      responses:
        '200':
          description: Xác nhận cuối cùng thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders/{orderId}/cancel:
    put:
      tags: [Order]
      summary: Hủy đơn hàng
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  maxLength: 500
      responses:
        '200':
          description: Hủy đơn hàng thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders/{orderId}/contract:
    get:
      tags: [Order]
      summary: Tải hợp đồng PDF
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Tải hợp đồng thành công
          content:
            application/pdf:
              schema:
                type: string
                format: binary
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy đơn hàng
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/orders/{orderId}/regenerate-contract:
    post:
      tags: [Order]
      summary: Tạo lại hợp đồng
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Tạo lại hợp đồng thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy đơn hàng
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/refunds:
    post:
      tags: [Refund]
      summary: Tạo yêu cầu hoàn tiền
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                orderId:
                  type: string
                reason:
                  type: string
                  enum:
                    - buyer_changed_mind
                    - car_not_as_described
                    - seller_fraud
                    - delivery_failed
                    - other
                description:
                  type: string
                  minLength: 10
                  maxLength: 1000
                evidence:
                  type: array
                  items:
                    type: string
                    format: uri
              required:
                - orderId
                - reason
                - description
      responses:
        '200':
          description: Tạo yêu cầu hoàn tiền thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Lỗi dữ liệu đầu vào
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags: [Refund]
      summary: Lấy danh sách yêu cầu hoàn tiền
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: role
          schema:
            type: string
            enum: [requester, seller, all]
          description: Vai trò của người dùng
        - in: query
          name: status
          schema:
            type: string
            enum: [requested, processing, approved, rejected, completed]
          description: Trạng thái yêu cầu hoàn tiền
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
          description: Trang hiện tại
        - in: query
          name: limit
          schema:
            type: integer
            minimum: 1
            maximum: 100
          description: Số lượng yêu cầu mỗi trang
        - in: query
          name: sortBy
          schema:
            type: string
            enum: [createdAt, updatedAt, requestedAmount, status]
          description: Sắp xếp theo
        - in: query
          name: sortOrder
          schema:
            type: string
            enum: [asc, desc]
          description: Thứ tự sắp xếp
      responses:
        '200':
          description: Danh sách yêu cầu hoàn tiền
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Refund'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/refunds/{refundId}:
    get:
      tags: [Refund]
      summary: Lấy chi tiết yêu cầu hoàn tiền
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: refundId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Chi tiết yêu cầu hoàn tiền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Refund'
        '401':
          description: Không có quyền
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy yêu cầu
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Lỗi máy chủ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/v1/refunds/{refundId}/seller-response:
    put:
      tags: [Refund]
      summary: Seller phản hồi yêu cầu hoàn tiền
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: refundId
          required: true